<!-- include footer -->
<%- include('include/_adminbase.ejs') %>
<!-- /include footer -->


<style>
    .custom-popup {
        display: none;
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(0, 0, 0, 0.5);
        justify-content: center;
        align-items: center;
    }

    .popup-content {
        background: #fff;
        padding: 20px;
        border-radius: 8px;
        box-shadow: 0 0 10px rgba(0, 0, 0, 0.2);
        text-align: center;
        width: 80%;
        max-width: 400px;
    }

    #popup-message {
        font-size: 16px;
        margin-bottom: 20px;
    }

    .button-container {
        display: flex;
        justify-content: center;
    }

    .popup-content button {
        margin: 0 10px;
        padding: 10px;
        cursor: pointer;
        border: none;
        border-radius: 5px;
        color: #fff;
    }

    #confirm-delete {
        background-color: #d9534f;
    }

    #cancel-delete {
        background-color: #5bc0de;
    }
    #status-red {
    appearance: none;
    -webkit-appearance: none;
    -moz-appearance: none;
    width: 20px;
    height: 20px;
    border-radius: 50%;
    border: 2px solid #ff0000; /* Red border color */
    outline: none;
    background-color: #ff0000;
    position: relative;
}
    #status-green {
    appearance: none;
    -webkit-appearance: none;
    -moz-appearance: none;
    width: 20px;
    height: 20px;
    border-radius: 50%;
    border: 2px solid green; /* Red border color */
    outline: none;
    background-color:green;
    position: relative;
}
button {
      padding: 8px 16px;
      margin: 4px;
      font-size: 14px;
      cursor: pointer;
      border: none;
      border-radius: 4px;
      color: #fff;
    }
    button.active {
      background-color: #4CAF50; /* Green */
    }

    button.inactive {
      background-color: #f44336; /* Red */
    }
</style>

	<!-- CONTENT -->
	<section id="content">
		<!-- NAVBAR -->
	
		<!-- NAVBAR -->

		<!-- MAIN -->
		<main>
		

			<div class="container">
                <!-- Search -->
                <div id="search-baron"> 
                  <h3>COUPONS</h3>
                </div>
                <div style="display: flex;justify-content: space-between;">
                    <div style="display: flex; justify-content: center; width: 100%; align-items: center;">
                    
                        <div style="width: 100%; " >
                        <input type="text" name="name" placeholder="Search Here" id="name-search"  style="width: 30%;
                        padding: .6em 1em;
                        margin: .5em 0;
                        border: 1px solid gray;
                        font-family: 'Barlow', sans-serif;
                        font-size: 1em;
                        border-radius: 10px;">
                        <i class="fa fa-search"></i>
                    </div>
                    </div>
                    <div style="height: 40px; display: flex; width: 50%; align-items:center; justify-content: space-between;">
                        <a href="/addcoupon"><button type="submit" style="background-color: rgb(245, 234, 234);" class="btn border-shadow update">
                            <p style="padding: 0px; margin: 0px; color: rgb(0, 0, 0);">Add coupon</p>
                        </button></a>
                            
                    </div>
                    
                    
                    
                </div>


                
                <div style="width: 100%;height: 30px;"></div>
                
               
                
                <!-- form handling -->
                <form action="/" method="POST">
                    <table class="table">
                        <thead class="thead-dark">
                            <tr>
                                <th>ID</th>
                                <th>Code</th>
                                <th>Discount</th>
                                <th>EXP</th>
                                <th>Delete</th>
                                <th>Status</th>

                            </tr>
                        </thead>
                        <tbody>
                            
                                <% for(let i=coupon.length-1;i>=0;i--){ %>
                                    <tr>
                                <td><%= coupon.length-i %></td>
                                <td><%= coupon[i].couponcode %></td>
                                <td><%= coupon[i].discount %></td>
                                <td><%= coupon[i].expdate %></td>
                                <td><a href="javascript:void(0);"  class="btn btn-light border px-2 pt-2 icon-hover" onclick="if(confirmDelete('<%=coupon[i]._id %>')) window.location.href = '/api/deletecoupon?id=';"><i class="fas fa-trash fa-lg text-secondary px-1"></i></a></td>
                            </td>
                            <td>
                               <% if(coupon[i].status=='active'){%>
                                    <input type="radio" name="status" id="status-green" value="red">
                                <%}else{%>
                                    <input type="radio" name="status" id="status-red" value="red">
                                <%}%>
                                
                            </td>
                        </tr>
                                <% } %>
                            
                        </tbody>
                    </table>
                </form>
                
            </div>
               

			
		</main>
		<!-- MAIN -->
	</section>
	<section id="content">
		<!-- NAVBAR -->
	
		<!-- NAVBAR -->

		<!-- MAIN -->
		<main>
		

			<div class="container">
                <!-- Search -->
                <div id="search-baron"> 
                  <h3>OFFERS</h3>
                </div>
                <div style="display: flex;justify-content: space-between;">
                    <div style="display: flex; justify-content: center; width: 100%; align-items: center;">
                    
                        <div style="width: 100%; " >
                        <input type="text" name="name" placeholder="Search Here" id="name-search"  style="width: 30%;
                        padding: .6em 1em;
                        margin: .5em 0;
                        border: 1px solid gray;
                        font-family: 'Barlow', sans-serif;
                        font-size: 1em;
                        border-radius: 10px;">
                        <i class="fa fa-search"></i>
                    </div>
                    </div>
                    <div style="height: 40px; display: flex; width: 50%; align-items:center; justify-content: space-between;">
                        <a href="/addoffer"><button type="submit" style="background-color: rgb(245, 234, 234);" class="btn border-shadow update">
                            <p style="padding: 0px; margin: 0px; color: rgb(0, 0, 0);">Add offer</p>
                        </button></a>
                            
                    </div>
                    
                    
                    
                </div>


                
                <div style="width: 100%;height: 30px;"></div>
                
               
                
                <!-- form handling -->
                    <table class="table">
                        <thead class="thead-dark">
                            <tr>
                                <th>ID</th>
                                <th>Category</th>
                                <th>Discount</th>
                                <th>Min Price</th>
                                <th>EXP</th>
                                <th>Change Satus</th>
                                <th>Status</th>

                            </tr>
                        </thead>
                        <tbody>
                            
                                <% for(let i=offer.length-1;i>=0;i--){ %>
                                    <tr>
                                <td><%= offer.length-i %></td>
                                <td><%= offer[i].category %></td>
                                <td><%= offer[i].discount %></td>
                                <td><%= offer[i].min %></td>
                                <td><%= offer[i].expdate %></td>
                                <td>
                                    <% if(offer[i].status=='active'){%>
                                        <a href="/api/inactiveoffer?id=<%= offer[i]._id %>"><button  class="inactive">Inactive</button></a>
                                        
                                    <%}else{%>
                                        <a href="/api/activeoffer?id=<%= offer[i]._id %>"><button  class="active">Active</button></a>
                                        
                                    <%}%>
                                    
                                    

                                </td>
                            
                            <td>
                               <% if(offer[i].status=='active'){%>
                                    <input type="radio" name="status" id="status-green" value="red">
                                <%}else{%>
                                    <input type="radio" name="status" id="status-red" value="red">
                                <%}%>
                                
                            </td>
                        </tr>
                                <% } %>
                            
                        </tbody>
                    </table>
                
            </div>
               

			
		</main>
		<!-- MAIN -->
	</section>
    <div id="custom-popup" class="custom-popup">
        <div class="popup-content">
            <p id="popup-message">Are you sure you want to delete this category?</p>
            <div class="button-container">
                <button id="confirm-delete">Yes</button>
                <button id="cancel-delete">Cancel</button>
            </div>
        </div>
    </div>
	<!-- CONTENT -->
	<script>
        function showPopup(message) {
        document.getElementById('popup-message').innerText = message;
        document.getElementById('custom-popup').style.display = 'flex';
    }

    function hidePopup() {
        document.getElementById('custom-popup').style.display = 'none';
    }

    function confirmDelete(id) {
        showPopup('Are you sure you want to delete this category?');

        document.getElementById('confirm-delete').addEventListener('click', function () {
            console.log('reach here');
            // If the user clicks 'Yes', proceed with the deletion
            window.location.href = `/api/deletecoupon?id=${id}`;
        });

        document.getElementById('cancel-delete').addEventListener('click', function () {
            // If the user clicks 'Cancel', hide the popup
            hidePopup();
        });
    }
    </script>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="/js/search.js"></script>
    
</body>
</html>

